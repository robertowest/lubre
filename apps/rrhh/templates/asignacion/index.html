{% extends "rrhh/base.html" %}
{% load static %}

{% comment %}

    Empleado
        puede tener documentación
            la documentación puede tener mantenimiento

        puede tener asignación de activos
            el activo puede tener mantenimiento
            el activo puede tener documentación
                la documentación del activo puede tener mantenimiento

{% endcomment %}

{% block content %}
    <div class="container">
        <table cellpadding="10" cellspacing="10" width="100%">
            <thead>
                <tr>
                    <td id="seleccion" colspan="3">
                        <h5>Selección:</h5>
                    </td>
                </tr>
            </thead>
            <tr>
                <!-- documentos -->
                <td>
                    <div id="doc" class="shadow-lg p-3 mb-5 bg-white rounded">
                        {% include 'asignacion/ajax/doc_ajax.html' %}
                    </div>
                </td>
                <!-- documento-mantenimiento -->
                <td colspan="2" style="vertical-align: top">
                    <div id="doc-man" class="shadow p-3 mb-5 bg-white rounded">
                        <h5>Mantenimiento del documento</h5>
                    </div>
                </td>
            </tr>
            <tr>
                <!-- activos -->
                <td rowspan="2" style="vertical-align: top">
                    <div id="act" class="shadow p-3 mb-5 bg-white rounded">
                        {% include 'asignacion/ajax/act_ajax.html' %}
                    </div>
                </td>
                <!-- activo-mantenimiento -->
                <td colspan="2">
                    <div id="act-man" class="shadow p-3 mb-5 bg-white rounded">
                        <h5>Mantenimiento del activo</h5>
                    </div>
                </td>
            </tr>
            <tr>
                <!-- activo-documentos -->
                <td>
                    <div id="act-doc" class="shadow p-3 mb-5 bg-white rounded">
                        <h5>Documento del activo</h5>
                    </div>
                </td>
                <!-- activo-documento-mantenimiento -->
                <td style="vertical-align: top">
                    <div id="act-doc-man" class="shadow p-3 mb-5 bg-white rounded">
                        <h5>Mantenimiento del documento del activo</h5>
                    </div>
                </td>
            </tr>
        </table>
    </div>

{% endblock %}

{% block js %}
    <script>
         // olcultamos los cuadros en función de la información
        $(document).ready (function () {
            {% if not Doc %}
                $('#doc-man').hide();
            {% endif %}
            {% if not Act %}
                $('#act-man').hide();
                $('#act-doc').hide();
                $('#act-doc-man').hide();
            {% endif %}
        });

        // miga de pan, al pulsar sobre los enlaces habilitados
        $(this).click(function(e) {
            $('#seleccion').html('<h5>Selección: ' + $(e.target).text() + '</h5>');
        });

        /*
            // FUERA DE SERVICIO
            $('a[name="doc"]').click(function(e) {
                alert( 'documento' + ' ' + $(e.target).attr("data-id") );
            });

            $('a[name="act"]').click(function(e) {
                alert( 'actividad' + ' ' + $(e.target).attr("data-id") );
            });
        */

        // cargamos la infromación al seleccionar un documento
        function documento(idref) {
            $.ajax({
                url: '/rrhh/doc_man_ajax/',
                data: {
                    id: idref
                },
                success: function(response) {
                    $('#doc-man').html(response);
                }
            });
        };

        // cargamos la infromación al seleccionar un activo
        function activo(idref) {
            $.ajax({
                url: '/rrhh/act_man_ajax/',
                data: {
                    id: idref
                },
                success: function(response) {
                    $('#act-man').html(response);
                }
            });

            // documentación del activo
            $.ajax({
                url: '/rrhh/act_doc_ajax/',
                data: {
                    id: idref
                },
                success: function(response) {
                    $('#act-doc').html(response);
                }
            });
        };

        // cargamos la infromación al seleccionar un activo-documento
        function activo_documento(idref) {
            // documento del mantenimientos del activo

            $.ajax({
                url: '/rrhh/act_doc_man_ajax/',
                data: {
                    id: idref
                },
                success: function(response) {
                    $('#act-doc-man').html(response);
                }
            });
         };

    </script>
{% endblock %}
